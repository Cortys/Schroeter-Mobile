/*******************************************************************************************
By Clemens Damke - 2011 - Deltamedia
This file contains the complete file loading system, touch engine and multi device support
especially developed for this project. Do not modify anything here! Apply changes in the
files being in the pages-folders and the defaults.js in this directory.

Frameworks used:
	jQuery - iScroll - touchSwipe - zFlow(very many mods here, made for this project)
*******************************************************************************************/
function clickRun(a,b,c){b=!b?$(a.target):b;var d=b.attr("name");var e=b.attr("alt");switch(d){case"linkDeep":linkLoad(e,"deep");break;case"linkBack":linkLoad("","back");break;case"linkReplace":linkLoad(e,"replace");break;case"linkAbsolute":linkLoad(e,"absolute");break;case"linkMail":location.href="mailto:"+e;break;case"linkPDF":window.open("pdfs/"+e+".pdf");break;default:if(!c)clickRun(a,b.parent(),1);break}}function linkLoad(a,b){if(!pageLoading){var c=[];var d="";var e=String(location.hash).split("#")[1];switch(b){case"deep":d=e+"-"+a;break;case"back":c=String(e).split("-");d=c.slice(0,-1).join("-");a=c[c.length-2];break;case"replace":c=String(e).split("-");d=c.slice(0,-1).join("-")+"-"+a;break;case"absolute":d=a;a=d.split("-");a=a[a.length-1];break;default:d=e;break}location.hash=d;pageLoad(a)}}function pageLoad(a,b){pageLoading=true;var c=a;var d=b?0:defaults["pageFade"];var e=false;$("#loadedPage,#subNav").fadeOut(d,function(){if(!e){var a=defaults["bgDict"][c]?defaults["bgDict"][c]:c+".jpg";var b=defaults["cssDict"][c]?defaults["cssDict"][c]:c;var f=defaults["scriptDict"][c]?defaults["scriptDict"][c]:c;var g=new Image;g.onload=function(){$.post("pages/"+c+".php",function(a){var b=defaults["menuReg"];var c=a.match(b);$("#subNav").html(c[1]).fadeIn(d);a=a.replace(b,"");$("#loadedPage").html(a).fadeIn(d);setTimeout(function(){$.ajax({url:"js/pages/"+f+".js",dataType:"script",complete:function(){if(!iTD()){$("#topNav").css({width:"1024px",left:"50%",marginLeft:"-512px"});$("#wheelErg").css({position:"absolute"})}}})},0);pageLoading=false},"html");$("head .added").remove();$("head").append('<link rel="stylesheet" href="css/pages/'+b+'.css" type="text/css" class="added">');$("body").css({backgroundImage:"url('images/bgs/"+a+"')"})};g.src="images/bgs/"+a;$("body").css({backgroundImage:"none"})}e=!e})}function iTD(){var a=document.createElement("div");a.setAttribute("ongesturestart","return;");return typeof a.ongesturestart=="function"||/android/gi.test(navigator.appVersion)}jQuery.expr[":"].Contains=function(a,b,c){return jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0};var START=iTD()?"touchstart":"mousedown";var MOVE=iTD()?"touchmove":"mousemove";var END=iTD()?"touchend":"click";var theChecker=function(a){var b=this;var c=a?20:0;setTimeout(function(){if(!b.animating){var a=Math.round(b.y/64)*64;b.y=a;b._pos(b.x,b.y);a=Math.abs(Math.round(a/64))+2;var c=$(b.scroller).children("li").filter(function(a){return $(this).css("display")!="none"}).eq(a);sideRefresh(c)}},c)};var pageLoading;var windowWidth=window.innerWidth;$(document).ready(function(){document.ontouchmove=function(a){a.preventDefault()};var a=String(location.hash).split("#");a=a[a.length-1].split("-");var b=a[a.length-1];b=!b?defaults["defaultPage"]:b;a[a.length-1]=b;location.hash=a.join("-");pageLoad(b);if(!iTD()){$("#subNav").css("top","728px");$("#loadedPage,#subNav").css({width:"1024px",height:"768px",marginLeft:"-512px",left:"50%"});$("body").css({backgroundSize:"1024px",marginTop:"100px"});windowWidth=1024}else $("#subNav").css("top",window.innerHeight-40+"px");$("#loadedPage,#subNav").bind(END,function(a){clickRun(a)})})